<!DOCTYPE html>
<html lang="en"><head><title>Shutter controller with Arduino and Raspberry Pi</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira Sans:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;family=IBM Plex Mono:wght@400;600&amp;display=swap"/><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="Pascal's Digital Garden"/><meta property="og:title" content="Shutter controller with Arduino and Raspberry Pi"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Shutter controller with Arduino and Raspberry Pi"/><meta name="twitter:description" content="public ⚠️ Important: Before proceeding, please read the full Shutter controller - disclaimer."/><meta property="og:description" content="public ⚠️ Important: Before proceeding, please read the full Shutter controller - disclaimer."/><meta property="og:image:alt" content="public ⚠️ Important: Before proceeding, please read the full Shutter controller - disclaimer."/><meta property="twitter:domain" content="quartz.jzhao.xyz"/><meta property="og:url" content="https://quartz.jzhao.xyz/zettelkasten/Shutter-controller-with-Arduino-and-Raspberry-Pi"/><meta property="twitter:url" content="https://quartz.jzhao.xyz/zettelkasten/Shutter-controller-with-Arduino-and-Raspberry-Pi"/><link rel="icon" href="../static/icon.png"/><meta name="description" content="public ⚠️ Important: Before proceeding, please read the full Shutter controller - disclaimer."/><meta name="generator" content="Quartz"/><link href="../index.css" rel="stylesheet" type="text/css" spa-preserve/><style>.expand-button {
  position: absolute;
  display: flex;
  float: right;
  padding: 0.4rem;
  margin: 0.3rem;
  right: 0;
  color: var(--gray);
  border-color: var(--dark);
  background-color: var(--light);
  border: 1px solid;
  border-radius: 5px;
  opacity: 0;
  transition: 0.2s;
}
.expand-button > svg {
  fill: var(--light);
  filter: contrast(0.3);
}
.expand-button:hover {
  cursor: pointer;
  border-color: var(--secondary);
}
.expand-button:focus {
  outline: 0;
}

pre:hover > .expand-button {
  opacity: 1;
  transition: 0.2s;
}

#mermaid-container {
  position: fixed;
  contain: layout;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  display: none;
  backdrop-filter: blur(4px);
  background: rgba(0, 0, 0, 0.5);
}
#mermaid-container.active {
  display: inline-block;
}
#mermaid-container > #mermaid-space {
  border: 1px solid var(--lightgray);
  background-color: var(--light);
  border-radius: 5px;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: 80vh;
  width: 80vw;
  overflow: hidden;
}
#mermaid-container > #mermaid-space > .mermaid-content {
  padding: 2rem;
  position: relative;
  transform-origin: 0 0;
  transition: transform 0.1s ease;
  overflow: visible;
  min-height: 200px;
  min-width: 200px;
}
#mermaid-container > #mermaid-space > .mermaid-content pre {
  margin: 0;
  border: none;
}
#mermaid-container > #mermaid-space > .mermaid-content svg {
  max-width: none;
  height: auto;
}
#mermaid-container > #mermaid-space > .mermaid-controls {
  position: absolute;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--light);
  border: 1px solid var(--lightgray);
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 2;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: 1px solid var(--lightgray);
  background: var(--light);
  color: var(--dark);
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  font-family: var(--bodyFont);
  transition: all 0.2s ease;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:hover {
  background: var(--lightgray);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:active {
  transform: translateY(1px);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:nth-child(2) {
  width: auto;
  padding: 0 12px;
  font-size: 14px;
}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VSb290IjoiL2J1aWxkcy9ob21lbGFiL2RpZ2l0YWwtZ2FyZGVuL3F1YXJ0ei9jb21wb25lbnRzL3N0eWxlcyIsInNvdXJjZXMiOlsibWVybWFpZC5pbmxpbmUuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTs7QUFHRjtFQUNFO0VBQ0E7O0FBR0Y7RUFDRTs7O0FBS0Y7RUFDRTtFQUNBOzs7QUFJSjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTs7QUFHRjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBOztBQUdGO0VBQ0U7RUFDQTs7QUFJSjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7O0FBR0Y7RUFDRTs7QUFJRjtFQUNFO0VBQ0E7RUFDQSIsInNvdXJjZXNDb250ZW50IjpbIi5leHBhbmQtYnV0dG9uIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbG9hdDogcmlnaHQ7XG4gIHBhZGRpbmc6IDAuNHJlbTtcbiAgbWFyZ2luOiAwLjNyZW07XG4gIHJpZ2h0OiAwOyAvLyBOT1RFOiByaWdodCB3aWxsIGJlIHNldCBpbiBtZXJtYWlkLmlubGluZS50c1xuICBjb2xvcjogdmFyKC0tZ3JheSk7XG4gIGJvcmRlci1jb2xvcjogdmFyKC0tZGFyayk7XG4gIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWxpZ2h0KTtcbiAgYm9yZGVyOiAxcHggc29saWQ7XG4gIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgb3BhY2l0eTogMDtcbiAgdHJhbnNpdGlvbjogMC4ycztcblxuICAmID4gc3ZnIHtcbiAgICBmaWxsOiB2YXIoLS1saWdodCk7XG4gICAgZmlsdGVyOiBjb250cmFzdCgwLjMpO1xuICB9XG5cbiAgJjpob3ZlciB7XG4gICAgY3Vyc29yOiBwb2ludGVyO1xuICAgIGJvcmRlci1jb2xvcjogdmFyKC0tc2Vjb25kYXJ5KTtcbiAgfVxuXG4gICY6Zm9jdXMge1xuICAgIG91dGxpbmU6IDA7XG4gIH1cbn1cblxucHJlIHtcbiAgJjpob3ZlciA+IC5leHBhbmQtYnV0dG9uIHtcbiAgICBvcGFjaXR5OiAxO1xuICAgIHRyYW5zaXRpb246IDAuMnM7XG4gIH1cbn1cblxuI21lcm1haWQtY29udGFpbmVyIHtcbiAgcG9zaXRpb246IGZpeGVkO1xuICBjb250YWluOiBsYXlvdXQ7XG4gIHotaW5kZXg6IDk5OTtcbiAgbGVmdDogMDtcbiAgdG9wOiAwO1xuICB3aWR0aDogMTAwdnc7XG4gIGhlaWdodDogMTAwdmg7XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIGRpc3BsYXk6IG5vbmU7XG4gIGJhY2tkcm9wLWZpbHRlcjogYmx1cig0cHgpO1xuICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuNSk7XG5cbiAgJi5hY3RpdmUge1xuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgfVxuXG4gICYgPiAjbWVybWFpZC1zcGFjZSB7XG4gICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saWdodCk7XG4gICAgYm9yZGVyLXJhZGl1czogNXB4O1xuICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICB0b3A6IDUwJTtcbiAgICBsZWZ0OiA1MCU7XG4gICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSk7XG4gICAgaGVpZ2h0OiA4MHZoO1xuICAgIHdpZHRoOiA4MHZ3O1xuICAgIG92ZXJmbG93OiBoaWRkZW47XG5cbiAgICAmID4gLm1lcm1haWQtY29udGVudCB7XG4gICAgICBwYWRkaW5nOiAycmVtO1xuICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogMCAwO1xuICAgICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMXMgZWFzZTtcbiAgICAgIG92ZXJmbG93OiB2aXNpYmxlO1xuICAgICAgbWluLWhlaWdodDogMjAwcHg7XG4gICAgICBtaW4td2lkdGg6IDIwMHB4O1xuXG4gICAgICBwcmUge1xuICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgIGJvcmRlcjogbm9uZTtcbiAgICAgIH1cblxuICAgICAgc3ZnIHtcbiAgICAgICAgbWF4LXdpZHRoOiBub25lO1xuICAgICAgICBoZWlnaHQ6IGF1dG87XG4gICAgICB9XG4gICAgfVxuXG4gICAgJiA+IC5tZXJtYWlkLWNvbnRyb2xzIHtcbiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgIGJvdHRvbTogMjBweDtcbiAgICAgIHJpZ2h0OiAyMHB4O1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGdhcDogOHB4O1xuICAgICAgcGFkZGluZzogOHB4O1xuICAgICAgYmFja2dyb3VuZDogdmFyKC0tbGlnaHQpO1xuICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICAgIGJvcmRlci1yYWRpdXM6IDZweDtcbiAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG4gICAgICB6LWluZGV4OiAyO1xuXG4gICAgICAubWVybWFpZC1jb250cm9sLWJ1dHRvbiB7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICB3aWR0aDogMzJweDtcbiAgICAgICAgaGVpZ2h0OiAzMnB4O1xuICAgICAgICBwYWRkaW5nOiAwO1xuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1saWdodGdyYXkpO1xuICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodCk7XG4gICAgICAgIGNvbG9yOiB2YXIoLS1kYXJrKTtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgIGZvbnQtc2l6ZTogMTZweDtcbiAgICAgICAgZm9udC1mYW1pbHk6IHZhcigtLWJvZHlGb250KTtcbiAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcblxuICAgICAgICAmOmhvdmVyIHtcbiAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodGdyYXkpO1xuICAgICAgICB9XG5cbiAgICAgICAgJjphY3RpdmUge1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgxcHgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU3R5bGUgdGhlIHJlc2V0IGJ1dHRvbiBkaWZmZXJlbnRseVxuICAgICAgICAmOm50aC1jaGlsZCgyKSB7XG4gICAgICAgICAgd2lkdGg6IGF1dG87XG4gICAgICAgICAgcGFkZGluZzogMCAxMnB4O1xuICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl19 */</style><link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../static/contentIndex.json").then(data => data.json())</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://quartz.jzhao.xyz/index.xml"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image" content="https://quartz.jzhao.xyz/zettelkasten/Shutter-controller-with-Arduino-and-Raspberry-Pi-og-image.webp"/><meta property="og:image:url" content="https://quartz.jzhao.xyz/zettelkasten/Shutter-controller-with-Arduino-and-Raspberry-Pi-og-image.webp"/><meta name="twitter:image" content="https://quartz.jzhao.xyz/zettelkasten/Shutter-controller-with-Arduino-and-Raspberry-Pi-og-image.webp"/><meta property="og:image:type" content="image/.webp"/></head><body data-slug="zettelkasten/Shutter-controller-with-Arduino-and-Raspberry-Pi"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="..">Pascal's Digital Garden</a></h2><div class="spacer mobile-only"></div><div class="flex-component" style="flex-direction: row; flex-wrap: nowrap; gap: 1rem;"><div style="flex-grow: 1; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><div class="search"><button class="search-button"><p>Search</p><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></button><div class="search-container"><div class="search-space"><input autocomplete="off" class="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div class="search-layout" data-preview="true"></div></div></div></div></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="readermode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="readerIcon" fill="currentColor" stroke="currentColor" stroke-width="0.2" stroke-linecap="round" stroke-linejoin="round" width="64px" height="64px" viewBox="0 0 24 24" aria-label="Reader mode"><title>Reader mode</title><g transform="translate(-1.8, -1.8) scale(1.15, 1.2)"><path d="M8.9891247,2.5 C10.1384702,2.5 11.2209868,2.96705384 12.0049645,3.76669482 C12.7883914,2.96705384 13.8709081,2.5 15.0202536,2.5 L18.7549359,2.5 C19.1691495,2.5 19.5049359,2.83578644 19.5049359,3.25 L19.5046891,4.004 L21.2546891,4.00457396 C21.6343849,4.00457396 21.9481801,4.28672784 21.9978425,4.6528034 L22.0046891,4.75457396 L22.0046891,20.25 C22.0046891,20.6296958 21.7225353,20.943491 21.3564597,20.9931534 L21.2546891,21 L2.75468914,21 C2.37499337,21 2.06119817,20.7178461 2.01153575,20.3517706 L2.00468914,20.25 L2.00468914,4.75457396 C2.00468914,4.37487819 2.28684302,4.061083 2.65291858,4.01142057 L2.75468914,4.00457396 L4.50368914,4.004 L4.50444233,3.25 C4.50444233,2.87030423 4.78659621,2.55650904 5.15267177,2.50684662 L5.25444233,2.5 L8.9891247,2.5 Z M4.50368914,5.504 L3.50468914,5.504 L3.50468914,19.5 L10.9478955,19.4998273 C10.4513189,18.9207296 9.73864328,18.5588115 8.96709342,18.5065584 L8.77307039,18.5 L5.25444233,18.5 C4.87474657,18.5 4.56095137,18.2178461 4.51128895,17.8517706 L4.50444233,17.75 L4.50368914,5.504 Z M19.5049359,17.75 C19.5049359,18.1642136 19.1691495,18.5 18.7549359,18.5 L15.2363079,18.5 C14.3910149,18.5 13.5994408,18.8724714 13.0614828,19.4998273 L20.5046891,19.5 L20.5046891,5.504 L19.5046891,5.504 L19.5049359,17.75 Z M18.0059359,3.999 L15.0202536,4 L14.8259077,4.00692283 C13.9889509,4.06666544 13.2254227,4.50975805 12.7549359,5.212 L12.7549359,17.777 L12.7782651,17.7601316 C13.4923805,17.2719483 14.3447024,17 15.2363079,17 L18.0059359,16.999 L18.0056891,4.798 L18.0033792,4.75457396 L18.0056891,4.71 L18.0059359,3.999 Z M8.9891247,4 L6.00368914,3.999 L6.00599909,4.75457396 L6.00599909,4.75457396 L6.00368914,4.783 L6.00368914,16.999 L8.77307039,17 C9.57551536,17 10.3461406,17.2202781 11.0128313,17.6202194 L11.2536891,17.776 L11.2536891,5.211 C10.8200889,4.56369974 10.1361548,4.13636104 9.37521067,4.02745763 L9.18347055,4.00692283 L8.9891247,4 Z"></path></g></svg></button></div></div><div class="explorer" data-behavior="link" data-collapsed="collapsed" data-savestate="true" data-data-fns="{&quot;order&quot;:[&quot;filter&quot;,&quot;map&quot;,&quot;sort&quot;],&quot;sortFn&quot;:&quot;(a,b)=>!a.isFolder&amp;&amp;!b.isFolder||a.isFolder&amp;&amp;b.isFolder?a.displayName.localeCompare(b.displayName,void 0,{numeric:!0,sensitivity:\&quot;base\&quot;}):!a.isFolder&amp;&amp;b.isFolder?1:-1&quot;,&quot;filterFn&quot;:&quot;node=>node.slugSegment!==\&quot;tags\&quot;&amp;&amp;node.slugSegment!==\&quot;zettelkasten\&quot;&quot;,&quot;mapFn&quot;:&quot;node=>node&quot;}"><button type="button" class="explorer-toggle mobile-explorer hide-until-loaded" data-mobile="true" aria-controls="explorer-content"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><button type="button" class="title-button explorer-toggle desktop-explorer" data-mobile="false" aria-expanded="true"><h2>Explorer</h2><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div class="explorer-content" aria-expanded="false"><ul class="explorer-ul overflow" id="list-0"><li class="overflow-end"></li></ul></div><template id="template-file"><li><a href="#"></a></li></template><template id="template-folder"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div><button class="folder-button"><span class="folder-title"></span></button></div></div><div class="folder-outer"><ul class="content"></ul></div></li></template></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../zettelkasten/">zettelkasten</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>Shutter controller with Arduino and Raspberry Pi</a></div></nav><h1 class="article-title">Shutter controller with Arduino and Raspberry Pi</h1><p show-comma="true" class="content-meta"><time datetime="2025-03-01T13:16:00.000Z">Mar 01, 2025</time><span>15 min read</span></p></div></div><article class="popover-hint"><p><a href=".././tags/public" class="tag-link internal alias" data-slug="tags/public">public</a></p>
<p><em>⚠️ Important: Before proceeding, please read the full <a href="../zettelkasten/Shutter-controller---disclaimer" class="internal alias" data-slug="zettelkasten/Shutter-controller---disclaimer">Shutter controller - disclaimer</a>. By following this tutorial, you accept that you are doing so at your own risk.</em></p>
<p><em>Repository: &lt;a href=<a href="https://github.com/pascalweiss/shutter_controller%3Egithub.com/pascalweiss/shutter_controller" class="external">https://github.com/pascalweiss/shutter_controller>github.com/pascalweiss/shutter_controller<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></em></p>
<h1 id="introduction">Introduction<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#introduction" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>This tutorial will show you how to integrate your roller shutter into your home automation system.
With each chapter, we will increase the level of integration.
Since every chapter will provide an applicable result, you don’t have to finish the whole tutorial.
But if you you do, you will have a fully integrated roller shutter, that can be scheduled via Home Assistant.
You will be able to automatically set the shutter to a certain level at a certain time. See the following example:</p>
<h2 id="example-my-own-shutter-automation">Example: My own Shutter Automation<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#example-my-own-shutter-automation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>In the evening it automatically closes at sunset time.</li>
<li>In the morning the shutter is opened to 50%. So we can wake up with sunlight.</li>
<li>2 hours later - when everybody left the home - it is opened fully.</li>
</ul>
<p>Additionally I can always set the shutter level manually with a poti controller, that is mounted to the wall.</p>
<h1 id="basics-shutter-motors">Basics: Shutter motors<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#basics-shutter-motors" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>The only requirement for automating your roller shutter is a <em>tubular shutter motor</em> that is installed in the shutter axis.
Despite of the neutral- and the ground conductors, there are two phase conductors.
One for moving the shutter up- and one for moving it down.
By applying voltage on one of these phases, the motor starts rotating with constant speed in the corresponding direction.
(We will use this fact for estimating the current state of the shutter at Integration Level 3).</p>
<h1 id="integration-level-1-control-the-shutter-with-a-remote-switch">Integration level 1: Control the shutter with a remote switch<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#integration-level-1-control-the-shutter-with-a-remote-switch" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>This is the first step in this tutorial. We will now connect motor with a radio receiver and control it with a remote switch.
This step will also provide the foundation for further integration in the subsequent sections.</p>
<h3 id="required-hardware-components">Required hardware components:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#required-hardware-components" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><a href="https://www.amazon.de/-/en/gp/product/B07GXWWM9G/" class="external">433Mhz receiver<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> Receives commands via 433 Mhz and controls the motor with relays</li>
<li><a href="https://www.amazon.de/dp/B077RZZGS1/ref=cm_sw_em_r_mt_dp_ZB3DYS8NHCPRQ781RETJ" class="external">433Mhz remote switch<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> Sends commands via 433 Mhz  to control the motor.</li>
</ul>
<p>We begin by connecting the 433Mhz receiver to the motor.
As described in the basics section, the motor has two phase wires (one for UP, one for DOWN), a neutral- and a ground wire.
<strong>Caution: Before working on the wires, turn off the power!</strong>
Now each of these wires can be connected to the receiver by attaching it to the corresponding socket in the green area (see image).
The sockets in the blue area can optionally be used for applying a manual wall switch.</p>
<p>When every wire is connected (and isolated), we can turn on the power, again.
Finally you have to couple the remote switch to the receiver by
pressing the connect button - the LED starts flashing - , and by pressing one of the “ON” buttons on
the remote. The coupling was successful, when the LED on the receiver stopps flashing.</p>
<p><img src="../schema_remote.png" width="auto" height="auto" alt/></p>
<p>When everything is set up correctly, you are now able to control the motor with the remote.
By pressing either ON or OFF on the remote you will hear the clicking of a relay, and the motor will start moving in the corresponding direction.</p>
<h1 id="integration-level-2-control-the-shutter-with-an-arduino-and-a-poti">Integration level 2: Control the shutter with an arduino and a poti<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#integration-level-2-control-the-shutter-with-an-arduino-and-a-poti" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>Having a remote switch for controlling the motor is already a useful solution.
Still there are some drawbacks: First: the remote can’t be integrated into an automation system.
And second: For setting the shutter to a certain height, we have to do this manually by pressing and releasing the button for the right duration.
We will now solve this problem by replacing the remote with an Arduino and a 433 Mhz sender.
Additionally we will add a poti for setting the desired height of the shutter.</p>
<h3 id="required-hardware-components-1">Required Hardware Components:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#required-hardware-components-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><a href="https://www.amazon.de/-/en/dp/B01MS7DUEM/ref=twister_B07ZD346G2" class="external">Arduino microcontroller<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> By uploading our own custom C programs, we can send/read data via GPIO. First we’ll use it for sniffing the commands from the remote, then we’ll use it for controlling the shutter.</li>
<li><a href="https://www.amazon.de/dp/B07MY39VF8/ref=cm_sw_em_r_mt_dp_HZN8TG8RCR8E5B8KNRDV" class="external">433 Mhz sender<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> Used by the Arduino for sending 433 Mhz commands to the receiver.</li>
<li><a href="https://www.amazon.de/-/en/Aussel-Linear-Potentiometer-Terminal-Rotary/dp/B0734K6WYP/" class="external">B10k Linear Potentiometer<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> We’ll use this to set the desired height of the shutter.</li>
</ul>
<p>But before we can start, we have to do some preliminary work.</p>
<h2 id="sniffing-radio-commands-with-arduino">Sniffing radio commands with Arduino<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#sniffing-radio-commands-with-arduino" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>For replacing the remote we have to imitate it by sending the same values.
Therefore we will now build a little radio sniffer.
This is done as follows:</p>
<ol>
<li>Connect your Arduino via USB and make sure that everything is set up properly, so that you can compile and upload your own sketches to the micro controller. If you have problems here, you can follow e.g. this tutorial <a href="https://www.arduino.cc/en/Guide" class="external">https://www.arduino.cc/en/Guide<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li>Install the library RCSwitch. You can do this inside the Arduino IDE with the ‘Library Manager’.</li>
<li>Connect the D2 connector with the data connector of the 433 Mhz sender. Also connect VCC to 5V, and GND to GND (see the following schema).
Note: You may want to use jumper cables for the wiring, since you might want to reuse the Arduino as remote controller in the next step.</li>
</ol>
<p><img src="../schema_sniffer.png" width="auto" height="auto" alt/></p>
<ol>
<li>Now that everything is wired up, we install the sniffing software on the Arduino.
Copy &amp; paste the following code into the IDE or open the file in the repository (see above).</li>
</ol>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="C" data-theme="github-light github-dark"><code data-language="C" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>#include &quot;RCSwitch.h&quot;</span></span>
<span data-line><span>#include &lt;stdlib.h></span></span>
<span data-line><span>#include &lt;stdio.h></span></span>
<span data-line><span>RCSwitch mySwitch = RCSwitch();</span></span>
<span data-line><span>void setup() {</span></span>
<span data-line><span> Serial.begin(9600);</span></span>
<span data-line><span> mySwitch.enableReceive(0);</span></span>
<span data-line><span>}</span></span>
<span data-line><span>void loop() {</span></span>
<span data-line><span> if (mySwitch.available()) {</span></span>
<span data-line><span> int value = mySwitch.getReceivedValue();</span></span>
<span data-line><span> if (value == 0) {</span></span>
<span data-line><span> Serial.print(&quot;Unknown encoding&quot;);</span></span>
<span data-line><span> } else {</span></span>
<span data-line><span> Serial.print(&quot;Received &quot;);</span></span>
<span data-line><span> Serial.print( mySwitch.getReceivedValue() );</span></span>
<span data-line><span> Serial.print(&quot; / &quot;);</span></span>
<span data-line><span> Serial.print( mySwitch.getReceivedBitlength() );</span></span>
<span data-line><span> Serial.print(&quot;bit &quot;);</span></span>
<span data-line><span> Serial.print(&quot;Protocol: &quot;);</span></span>
<span data-line><span> Serial.println( mySwitch.getReceivedProtocol() );</span></span>
<span data-line><span> }</span></span>
<span data-line><span> mySwitch.resetAvailable();</span></span>
<span data-line><span> }</span></span>
<span data-line><span>}</span></span></code></pre></figure>
<ol>
<li>Compile and upload the sketch to the Arduino.</li>
<li>In the Arduino IDE, open the Serial Monitor and press the “ON”, “OFF” buttons on the remote.</li>
<li>The monitor should now print the received values from the remote. In my local example this looks as follows:</li>
</ol>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">21:23:06.515</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Received</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2821412352</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 32bit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Protocol:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">21:23:07.184</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Received</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2687194624</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 32bit</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Protocol:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span></span></code></pre></figure>
<ol>
<li>Convert these values into binaries. You can use some online converter for this. The resulting values should be 32 bit numbers.
E.g. 2821412352 becomes 10101000001010110101011000000000</li>
</ol>
<p>Voilà! Now we know the commands for remote control of the motor.
Write them down! You will need them in the next step.
If you don’t want to reuse the sniffer for another shutter later, you can now disassemble it (this is why you should use jumper cables).</p>
<h2 id="build-a-poti-controlled-programmable-433-mhz-sender">Build a poti-controlled, programmable 433 Mhz sender<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#build-a-poti-controlled-programmable-433-mhz-sender" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Before we install the final software on the Arduino, let us first set up the hardware.
Connect GND to GND and VCC to 5V for both, the poti and the sender.
Also connect the data connector of the sender to D7 and the remaining poti connector to A0.
See the sketch for an example:</p>
<p><img src="../schema_poti.png" width="auto" height="auto" alt/></p>
<h2 id="installation-and-callibration-of-the-software">Installation and callibration of the software<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#installation-and-callibration-of-the-software" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>The final step in this section is to install the software, and to provide some configuration values.</p>
<ol>
<li>Clone my github project to your local machine</li>
</ol>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/pascalweiss/shutter_controller.git</span></span></code></pre></figure>
<ol>
<li>Open the <code>shutter_remote_controller/shutter_remote_controller.ino</code> in Arduino IDE.</li>
<li>Open the tab <code>config_rf433.h</code></li>
<li>Assign the binary numbers that you sniffed previously to the variables <code>RF433_UP</code> and <code>RF433_DOWN</code>.</li>
</ol>
<p>The resulting config_rf433.h should look similar to this:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="C" data-theme="github-light github-dark"><code data-language="C" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>...</span></span>
<span data-line><span>// set this to the corresponding digital pin</span></span>
<span data-line><span>byte PIN_RF433 = 7;</span></span>
<span data-line> </span>
<span data-line><span>// The value that is sent for moving the shutter up.</span></span>
<span data-line><span>// You have to sniff it from a remote control</span></span>
<span data-line><span>#define RF433_UP &quot;10101000001010110101011000000000&quot; </span></span>
<span data-line> </span>
<span data-line><span>// The value that is sent for moving the shutter down.</span></span>
<span data-line><span>// You have to sniff it from a remote control</span></span>
<span data-line><span>#define RF433_DOWN &quot;10100000001010110101011000000000&quot; </span></span>
<span data-line><span>...</span></span></code></pre></figure>
<ol>
<li>Measure the required time for opening and closing the shutter completely</li>
<li>Assign the values to the variables <code>SECS_ROLL_UP</code> and <code>SECS_ROLL_DOWN</code> in <code>config_application.h</code></li>
</ol>
<p><strong>Note:</strong> The file <code>config_application.h</code> provides many other configuration properties, that you might have to adjust.
Explaining each of these properties would require to explain the whole algorthm.
This would exceed the scope of this tutorial and it is likely that the default values will just work.
But if you do have to adjust the other configuration properties, the code documentation provides some hints.</p>
<p>Congratulations! You just built your own remote shutter controller.
This set up is already quite useful since controlling the shutter with a poti is much more convenient than pressing a button for a certain amount of time.
If you are not interessted in further integration you can now install your Arduino remote in a plastic box and mount it to the wall (maybe next to the light switch).
Otherwise, if you want to integrate the Arduino with a raspberry pi and Home Assistant,
you will have to add another communication module to the Arduino. So you might want to wait with installing your device into a plastic box.</p>
<h1 id="integration-level-3-control-the-shutter-with-a-raspberry-pi-and-python">Integration Level 3: Control the Shutter with a Raspberry Pi and Python<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#integration-level-3-control-the-shutter-with-a-raspberry-pi-and-python" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>In this step we will set up a little single-board computer - a Raspberry Pi - and integrate it with the Arduino.
We will set up a little flask server that is able to send a desired shutter height via an NRF24 module.
The server itself will receive commands via a REST API.
So in the end, the motor will be controlable over the network with http.</p>
<h3 id="required-hardware-components-2">Required Hardware Components:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#required-hardware-components-2" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><a href="https://www.amazon.de/-/en/Raspberry-1373331-Model-Motherboard-1GB/dp/B07BFH96M3/" class="external">Raspberry Pi mini computer<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> A little computer that is mainly used for DIY projects and education. It is cheap, consumes low amounts of power and provides GPIO for connecting low-level hardware componets. We will use it for sending data to the Arduino, and for hosting Home Assistant.</li>
<li><a href="https://www.amazon.de/AZDelivery-NRF24L01-wireless-modules-Raspberry/dp/B075DBDS3J" class="external">NRF24L01 transceiver<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> Communication module for sending/receiving digital data. We will use it for sending the target shutter height from the Pi to Arduino.</li>
<li><a href="https://www.amazon.de/-/en/SanDisk-Ultra-microSDHC-memory-adapter/dp/B073JWXGNT" class="external">SD Card<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> Used as disk for the Raspberry Pi.</li>
</ul>
<h2 id="some-system-prerequisites">Some system prerequisites<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#some-system-prerequisites" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>The Raspberry Pi should the raspbian linux distribution. You can install this by flashing the SD-Card with the newest raspbian version. Instructions on how to do this are plentiful available on the internet.</li>
<li>Since NRF24 use SPI, we have to enable it on the pi. Therefore we have to start up the Pi and execute <code>sudo raspi-config</code></li>
<li>There you should go to <code>Interface-Options > P4 SPI</code> and enable it</li>
<li>Also we have to expand the filesystem here <code>Advanced Options > A1 Expand Filesystem</code></li>
<li>Finally go to <code>save</code> the Pi should reboot now, automatically.</li>
</ul>
<h2 id="wire-up-nrf24-transceiver-with-arduino-and-pi">Wire up NRF24 Transceiver with Arduino and Pi<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#wire-up-nrf24-transceiver-with-arduino-and-pi" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>First we have to wire everything up. The NRF24 has 8 connectors from which 7 have to be connected to both, the Arduino and the Pi.
The exact wiring is visualized in the following schema, as well as in the following table.</p>























































<div class="table-container"><table><thead><tr><th style="text-align:center;">NRF24</th><th style="text-align:center;">Arduino Nano</th><th style="text-align:center;">Pi 4</th></tr></thead><tbody><tr><td style="text-align:center;">VCC</td><td style="text-align:center;">3.3V</td><td style="text-align:center;">3.3V (e.g. 1)</td></tr><tr><td style="text-align:center;">GND</td><td style="text-align:center;">GND</td><td style="text-align:center;">GND (e.g. 6)</td></tr><tr><td style="text-align:center;">CSN</td><td style="text-align:center;">D10</td><td style="text-align:center;">GPIO7 (26)</td></tr><tr><td style="text-align:center;">CE</td><td style="text-align:center;">D9</td><td style="text-align:center;">GPIO22 (15)</td></tr><tr><td style="text-align:center;">MOSI</td><td style="text-align:center;">D11</td><td style="text-align:center;">GPIO10 (19)</td></tr><tr><td style="text-align:center;">SCK</td><td style="text-align:center;">D13</td><td style="text-align:center;">GPIO11 (23)</td></tr><tr><td style="text-align:center;">IRQ</td><td style="text-align:center;">-</td><td style="text-align:center;">-</td></tr><tr><td style="text-align:center;">MISO</td><td style="text-align:center;">D12</td><td style="text-align:center;">GPIO9 (21)</td></tr><tr><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;"></td></tr></tbody></table></div>
<p><a href="../schema_nrf24.png" class="internal" data-slug="schema_nrf24.png">schema_nrf24.png</a></p>
<h2 id="install-nrf24-library-for-arduino-and-raspberry-pi">Install NRF24 library for Arduino and Raspberry Pi<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#install-nrf24-library-for-arduino-and-raspberry-pi" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Now we will install the library on Arduino and Raspberry Pi.
There are various libraries available for the NRF24.
Since they don’t seem to be compatible to each other (at least not for communication between Arduino and Raspberry Pi), we have to make sure to use the libraries from the same project.
I had good results with TMRh20s libraries. For installing, do the following:</p>
<ul>
<li>On the Raspberry Pi, install the NRF24 library with python-wrapper. The library has to be compiled on the Pi. So this will take some time. Instructions for the installation can be found here: <a href="https://nrf24.github.io/RF24/Python.html" class="external">https://nrf24.github.io/RF24/Python.html<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li>In the Arduino IDE, you should find TMRh20s NRF24 library in the ‘Library Manager’.</li>
</ul>
<p>Now you should be able to exchange data from the Pi to the Arduino and the other way around.
Various examples can be found here <a href="https://nrf24.github.io/RF24/examples.html" class="external">https://nrf24.github.io/RF24/examples.html<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> and are well described on other parts of the page, or on blogs like <a href="https://tmrh20.blogspot.com/" class="external">https://tmrh20.blogspot.com/<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a>.</p>
<h2 id="install-a-flask-server-for-controlling-over-http">Install a flask server for controlling over http<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#install-a-flask-server-for-controlling-over-http" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Now that we have set up the NRF24 tranceiver we will now use it for controlling the shutter.
After this step we will have a little flask server on the Pi, that is able to receive a desired shutter heigt via http GET requests.
The server will then send the desired shutter height via NRF24 to the Arduino.
Similar to a changed value with the poti, the Arduino will then control the motor over 433 Mhz radio commands and set the desired height.
We will also ensure that the flask server started at boot up.
So every time you power up the Pi, the server will be available. So let’s see how to do this step-by-step.</p>
<p>The project is written in python3. This should already be installed on your Pi. If not, do</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python3-pip</span></span></code></pre></figure>
<p>To check if everything worked, you can do</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --version</span></span></code></pre></figure>
<p>As you did before when you set up the Arduino, we will now clone the project again on the Pi.</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/pascalweiss/shutter_controller.git</span></span></code></pre></figure>
<p>Now navigate to the project and install the requirements.</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">path-to-rep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">o</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">></span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/shutter_controller/shutter_remote_api</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pip3</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> requirements.txt</span></span></code></pre></figure>
<p>Now you should already be able to start up the server with <code>python3 api.py</code> and send control requests.
But since we want to start up the server automatically on every boot, we have to set it up as a systemctl service:</p>
<p>Create a new service in <code>/etc/systemd/system</code>. You can do this with your favorite editor, like:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vim</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/systemd/system/shutter_remote_api.service</span></span></code></pre></figure>
<p>Then write the following code into the file:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Unit]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Description</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">REST</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> api</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sending</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> commands</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shutter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> controllers</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> via</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RF24</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Service]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Type</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">simple</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ExecStart</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">/usr/bin/python3</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /home/pi/dev/shutter_controller/shutter_remote_api/api.py</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[Install]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">WantedBy</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">multi-user.target</span></span></code></pre></figure>
<p>Now reboot your Pi. When it is up again, the new service should be running. You should be able to print its logs with</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> journalctl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shutter_remote_api.service</span></span></code></pre></figure>
<p>Here you should get some output like:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Mar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:32:35</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> raspberrypi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemd[1]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Started</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> REST</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> api</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sending</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> commands</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> shutter</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> controllers</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> via</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> RF24.</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Mar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:32:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> raspberrypi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python3[391]:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Serving</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Flask</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> app</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;api&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (lazy </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">loading</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Mar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:32:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> raspberrypi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python3[391]:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Environment:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> production</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Mar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:32:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> raspberrypi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python3[391]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    WARNING:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Do</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> development</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> production</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> environment.</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Mar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:32:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> raspberrypi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python3[391]:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    Use</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> production</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> WSGI</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> instead.</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Mar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:32:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> raspberrypi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python3[391]:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Debug</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mode:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Mar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 30</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 19:32:40</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> raspberrypi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python3[391]:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  *</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Running</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> http://127.0.0.1:8081/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Press </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">CTRL+C</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> quit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span></code></pre></figure>
<p>If you get similar logs, you are done now. When the Arduino is set up as previously described, you should now be able to set the shutter hight via http. E.g. you could do a curl command as follows (note that the height is provided as percent in a json):</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light github-dark"><code data-language="bash" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost:8081/setShutterLevel</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --data</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> '{&quot;level&quot;: 0.64}'</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --header</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Content-Type:application/json&quot;</span></span></code></pre></figure>
<h1 id="integration-level-4-control-the-shutter-with-a-raspberry-pi-and-home-assistant">Integration Level 4: Control the Shutter with a Raspberry Pi and Home Assistant<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#integration-level-4-control-the-shutter-with-a-raspberry-pi-and-home-assistant" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p>This is the last step to the full integration of the remote controller.
Instead of manually sending http requests (like in the previous example) we will now finally install Home Assistant.
This will not only provide a nice UI for controlling the shutter,
it will also provide the ability to scheduling control commands.
Therefore we can use various triggers like sunrise/sunset or weekdays and time.
In the following steps we will configure Home Assistant similar to the setup described in the introduction:</p>
<ol>
<li>We will open the shutter on weekdays at a certain time</li>
<li>We will close it at sunrise.</li>
</ol>
<h2 id="home-assistant-installation">Home Assistant Installation<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#home-assistant-installation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Of course we first have to install Home Assistant on the Raspberry Pi.
The Home Assistant documentation describes various ways for installing the software.
Since I want to use the Raspberry Pi for other things as well (like the flask server),
I chose to install the software as a docker container. A guide on how to do this is provided here
&lt;a href=<a href="https://www.home-assistant.io/installation/raspberrypi%3Ehome-assistant.io/installation/raspberrypi" class="external">https://www.home-assistant.io/installation/raspberrypi>home-assistant.io/installation/raspberrypi<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<h2 id="home-assistant-configuration">Home Assistant Configuration<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#home-assistant-configuration" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Now that we have a running Home Assistant deployment, we can configure it for controlling the shutter.</p>
<ol>
<li>Add the following services to <code>&lt;path-to-homeassistant/config/configuration.yaml</code></li>
</ol>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="C" data-theme="github-light github-dark"><code data-language="C" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>rest_command:</span></span>
<span data-line><span>  open_full:</span></span>
<span data-line><span>          url: &quot;http://localhost:8081/setShutterLevel&quot;</span></span>
<span data-line><span>          method: &quot;post&quot;</span></span>
<span data-line><span>          content_type: &quot;application/json&quot;</span></span>
<span data-line><span>          payload: '{&quot;level&quot;: 0.0}'</span></span>
<span data-line><span>  open_half:</span></span>
<span data-line><span>          url: &quot;http://localhost:8081/setShutterLevel&quot;</span></span>
<span data-line><span>          method: &quot;post&quot;</span></span>
<span data-line><span>          content_type: &quot;application/json&quot;</span></span>
<span data-line><span>          payload: '{&quot;level&quot;: 0.5}'</span></span>
<span data-line><span>  close:</span></span>
<span data-line><span>          url: &quot;http://localhost:8081/setShutterLevel&quot;</span></span>
<span data-line><span>          method: &quot;post&quot;</span></span>
<span data-line><span>          content_type: &quot;application/json&quot;</span></span>
<span data-line><span>          payload: '{&quot;level&quot;: 0.65}'</span></span>
<span data-line><span>binary_sensor:</span></span>
<span data-line><span>  - platform: workday</span></span>
<span data-line><span>    country: DE</span></span>
<span data-line><span>    workdays: [mon, tue, wed, thu, fri]</span></span>
<span data-line><span>    excludes: [sat, sun]</span></span></code></pre></figure>
<ol>
<li>Add the following scripts to <code>&lt;path-to-homeassistant/config/scripts.yaml</code></li>
</ol>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="C" data-theme="github-light github-dark"><code data-language="C" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>open_shutters_full:</span></span>
<span data-line><span>  alias: open shutters full</span></span>
<span data-line><span>  sequence:</span></span>
<span data-line><span>  - service: rest_command.open_full</span></span>
<span data-line><span>  mode: single</span></span>
<span data-line><span>  max: 10</span></span>
<span data-line><span>open_shutters_half:</span></span>
<span data-line><span>  alias: open shutters half</span></span>
<span data-line><span>  sequence:</span></span>
<span data-line><span>  - service: rest_command.open_half</span></span>
<span data-line><span>  mode: single</span></span>
<span data-line><span>  max: 10</span></span>
<span data-line><span>close_shutters:</span></span>
<span data-line><span>  alias: close shutters </span></span>
<span data-line><span>  sequence:</span></span>
<span data-line><span>  - service: rest_command.close</span></span>
<span data-line><span>  mode: single</span></span>
<span data-line><span>  max: 10 </span></span>
<span data-line> </span></code></pre></figure>
<ol>
<li>Add the following automations to <code>&lt;path-to-homeassistant/config/automation.yaml</code></li>
</ol>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="C" data-theme="github-light github-dark"><code data-language="C" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>- id: '1615669286832'</span></span>
<span data-line><span>  alias: Open shutters half</span></span>
<span data-line><span>  description: ''</span></span>
<span data-line><span>  trigger:</span></span>
<span data-line><span>  - platform: time</span></span>
<span data-line><span>    at: &quot;06:30:00&quot;</span></span>
<span data-line><span>  condition:</span></span>
<span data-line><span>    condition: state</span></span>
<span data-line><span>    entity_id: binary_sensor.workday_sensor</span></span>
<span data-line><span>    state: &quot;on&quot;</span></span>
<span data-line><span>  action:</span></span>
<span data-line><span>  - service: script.open_shutters_half</span></span>
<span data-line><span>  mode: single</span></span>
<span data-line><span>- id: '1615669286852'</span></span>
<span data-line><span>  alias: Open shutters full</span></span>
<span data-line><span>  description: ''</span></span>
<span data-line><span>  trigger:</span></span>
<span data-line><span>  - platform: time</span></span>
<span data-line><span>    at: &quot;07:45:00&quot;</span></span>
<span data-line><span>  condition:</span></span>
<span data-line><span>    condition: state</span></span>
<span data-line><span>    entity_id: binary_sensor.workday_sensor</span></span>
<span data-line><span>    state: &quot;on&quot;</span></span>
<span data-line><span>  action:</span></span>
<span data-line><span>  - service: script.open_shutters_full</span></span>
<span data-line><span>  mode: single</span></span>
<span data-line><span>- id: '1615669378243'</span></span>
<span data-line><span>  alias: Close shutters</span></span>
<span data-line><span>  description: ''</span></span>
<span data-line><span>  trigger:</span></span>
<span data-line><span>  - platform: sun</span></span>
<span data-line><span>    event: sunset</span></span>
<span data-line><span>  condition: []</span></span>
<span data-line><span>  action:</span></span>
<span data-line><span>  - service: script.close_shutters</span></span>
<span data-line><span>  mode: single</span></span></code></pre></figure>
<ol>
<li>Now open the Home Assistant overview in the browser <code>&lt;ip-of-the-raspberry>:8123/lovelace/default_view</code></li>
<li>In the three-dot menu on the top right, click “Edit Dashboard”.</li>
<li>The click ”+ Add Card” on the bottom right and choose “Manual” on the bottom of the list</li>
<li>Paste the following yaml in the txt field</li>
</ol>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="C" data-theme="github-light github-dark"><code data-language="C" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>type: entities</span></span>
<span data-line><span>entities:</span></span>
<span data-line><span>  - entity: automation.open_shutters_half</span></span>
<span data-line><span>    name: Open half in the morning</span></span>
<span data-line><span>    secondary_info: last-triggered</span></span>
<span data-line><span>  - entity: automation.open_shutters</span></span>
<span data-line><span>    name: Open full in the morning</span></span>
<span data-line><span>  - entity: automation.close_shutters</span></span>
<span data-line><span>    name: Close at sunset</span></span>
<span data-line><span>    secondary_info: last-triggered</span></span>
<span data-line><span>  - entity: script.open_shutters_half</span></span>
<span data-line><span>    name: Open half now</span></span>
<span data-line><span>  - entity: script.open_shutters_full</span></span>
<span data-line><span>    name: Open full now</span></span>
<span data-line><span>  - entity: script.close_shutters</span></span>
<span data-line><span>    name: Close now</span></span>
<span data-line><span>title: Rollladen</span></span></code></pre></figure>
<p>This will provide the following card to you:</p>
<p><img src="../screenshot_ha_shutter_card.png" width="auto" height="auto" alt/></p>
<p>By clicking enabling the switches you can turn on/off the various automations.
You can also execute the commands manually by clicking on “Run”.
If you want to change the parameters, e.g. for the automation, you can do this easily by
editing the .yaml files. You may also  want to create your own automation.</p>
<p>Congratulations, you have now finished the integration of the shutter controller.</p>
<p>06.05.21</p></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div class="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:2,&quot;scale&quot;:1.1,&quot;repelForce&quot;:1,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.8,&quot;opacityScale&quot;:1.2,&quot;showTags&quot;:false,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false,&quot;enableRadial&quot;:false,&quot;linkStrength&quot;:0.7,&quot;forceCenter&quot;:0.3,&quot;highlightTags&quot;:[&quot;software&quot;,&quot;engineering&quot;,&quot;code&quot;]}"></div><button class="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div class="global-graph-outer"><div class="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:1,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1.2,&quot;showTags&quot;:false,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true,&quot;enableRadial&quot;:true,&quot;linkStrength&quot;:0.7,&quot;forceCenter&quot;:0.3,&quot;highlightTags&quot;:[&quot;software&quot;,&quot;engineering&quot;,&quot;code&quot;]}"></div></div></div><div class="toc desktop-only"><button type="button" class="toc-header" aria-controls="toc-content" aria-expanded="true"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><ul class="toc-content overflow" id="list-1"><li class="depth-0"><a href="#introduction" data-for="introduction">Introduction</a></li><li class="depth-1"><a href="#example-my-own-shutter-automation" data-for="example-my-own-shutter-automation">Example: My own Shutter Automation</a></li><li class="depth-0"><a href="#basics-shutter-motors" data-for="basics-shutter-motors">Basics: Shutter motors</a></li><li class="depth-0"><a href="#integration-level-1-control-the-shutter-with-a-remote-switch" data-for="integration-level-1-control-the-shutter-with-a-remote-switch">Integration level 1: Control the shutter with a remote switch</a></li><li class="depth-2"><a href="#required-hardware-components" data-for="required-hardware-components">Required hardware components:</a></li><li class="depth-0"><a href="#integration-level-2-control-the-shutter-with-an-arduino-and-a-poti" data-for="integration-level-2-control-the-shutter-with-an-arduino-and-a-poti">Integration level 2: Control the shutter with an arduino and a poti</a></li><li class="depth-2"><a href="#required-hardware-components-1" data-for="required-hardware-components-1">Required Hardware Components:</a></li><li class="depth-1"><a href="#sniffing-radio-commands-with-arduino" data-for="sniffing-radio-commands-with-arduino">Sniffing radio commands with Arduino</a></li><li class="depth-1"><a href="#build-a-poti-controlled-programmable-433-mhz-sender" data-for="build-a-poti-controlled-programmable-433-mhz-sender">Build a poti-controlled, programmable 433 Mhz sender</a></li><li class="depth-1"><a href="#installation-and-callibration-of-the-software" data-for="installation-and-callibration-of-the-software">Installation and callibration of the software</a></li><li class="depth-0"><a href="#integration-level-3-control-the-shutter-with-a-raspberry-pi-and-python" data-for="integration-level-3-control-the-shutter-with-a-raspberry-pi-and-python">Integration Level 3: Control the Shutter with a Raspberry Pi and Python</a></li><li class="depth-2"><a href="#required-hardware-components-2" data-for="required-hardware-components-2">Required Hardware Components:</a></li><li class="depth-1"><a href="#some-system-prerequisites" data-for="some-system-prerequisites">Some system prerequisites</a></li><li class="depth-1"><a href="#wire-up-nrf24-transceiver-with-arduino-and-pi" data-for="wire-up-nrf24-transceiver-with-arduino-and-pi">Wire up NRF24 Transceiver with Arduino and Pi</a></li><li class="depth-1"><a href="#install-nrf24-library-for-arduino-and-raspberry-pi" data-for="install-nrf24-library-for-arduino-and-raspberry-pi">Install NRF24 library for Arduino and Raspberry Pi</a></li><li class="depth-1"><a href="#install-a-flask-server-for-controlling-over-http" data-for="install-a-flask-server-for-controlling-over-http">Install a flask server for controlling over http</a></li><li class="depth-0"><a href="#integration-level-4-control-the-shutter-with-a-raspberry-pi-and-home-assistant" data-for="integration-level-4-control-the-shutter-with-a-raspberry-pi-and-home-assistant">Integration Level 4: Control the Shutter with a Raspberry Pi and Home Assistant</a></li><li class="depth-1"><a href="#home-assistant-installation" data-for="home-assistant-installation">Home Assistant Installation</a></li><li class="depth-1"><a href="#home-assistant-configuration" data-for="home-assistant-configuration">Home Assistant Configuration</a></li><li class="overflow-end"></li></ul></div><div class="backlinks"><h3>Backlinks</h3><ul id="list-2" class="overflow"><li><a href="../" class="internal">index</a></li><li><a href="../zettelkasten/Projects" class="internal">Projects</a></li><li class="overflow-end"></li></ul></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.5.1</a> © 2025</p><ul><li><a href="https://github.com/jackyzha0/quartz">GitHub</a></li><li><a href="/zettelkasten/Coding%20Best%20Practices">Software Engineering</a></li><li><a href="https://quartz.jzhao.xyz/">Digital Garden</a></li></ul></footer></div></div></body><script type="application/javascript">function n(){let t=this.parentElement;t.classList.toggle("is-collapsed");let e=t.getElementsByClassName("callout-content")[0];if(!e)return;let l=t.classList.contains("is-collapsed");e.style.gridTemplateRows=l?"0fr":"1fr"}function c(){let t=document.getElementsByClassName("callout is-collapsible");for(let e of t){let l=e.getElementsByClassName("callout-title")[0],s=e.getElementsByClassName("callout-content")[0];if(!l||!s)continue;l.addEventListener("click",n),window.addCleanup(()=>l.removeEventListener("click",n));let o=e.classList.contains("is-collapsed");s.style.gridTemplateRows=o?"0fr":"1fr"}}document.addEventListener("nav",c);
</script><script type="module">function f(i,e){if(!i)return;function r(o){o.target===this&&(o.preventDefault(),o.stopPropagation(),e())}function t(o){o.key.startsWith("Esc")&&(o.preventDefault(),e())}i?.addEventListener("click",r),window.addCleanup(()=>i?.removeEventListener("click",r)),document.addEventListener("keydown",t),window.addCleanup(()=>document.removeEventListener("keydown",t))}function y(i){for(;i.firstChild;)i.removeChild(i.firstChild)}var h=class{constructor(e,r){this.container=e;this.content=r;this.setupEventListeners(),this.setupNavigationControls(),this.resetTransform()}isDragging=!1;startPan={x:0,y:0};currentPan={x:0,y:0};scale=1;MIN_SCALE=.5;MAX_SCALE=3;cleanups=[];setupEventListeners(){let e=this.onMouseDown.bind(this),r=this.onMouseMove.bind(this),t=this.onMouseUp.bind(this),o=this.resetTransform.bind(this);this.container.addEventListener("mousedown",e),document.addEventListener("mousemove",r),document.addEventListener("mouseup",t),window.addEventListener("resize",o),this.cleanups.push(()=>this.container.removeEventListener("mousedown",e),()=>document.removeEventListener("mousemove",r),()=>document.removeEventListener("mouseup",t),()=>window.removeEventListener("resize",o))}cleanup(){for(let e of this.cleanups)e()}setupNavigationControls(){let e=document.createElement("div");e.className="mermaid-controls";let r=this.createButton("+",()=>this.zoom(.1)),t=this.createButton("-",()=>this.zoom(-.1)),o=this.createButton("Reset",()=>this.resetTransform());e.appendChild(t),e.appendChild(o),e.appendChild(r),this.container.appendChild(e)}createButton(e,r){let t=document.createElement("button");return t.textContent=e,t.className="mermaid-control-button",t.addEventListener("click",r),window.addCleanup(()=>t.removeEventListener("click",r)),t}onMouseDown(e){e.button===0&&(this.isDragging=!0,this.startPan={x:e.clientX-this.currentPan.x,y:e.clientY-this.currentPan.y},this.container.style.cursor="grabbing")}onMouseMove(e){this.isDragging&&(e.preventDefault(),this.currentPan={x:e.clientX-this.startPan.x,y:e.clientY-this.startPan.y},this.updateTransform())}onMouseUp(){this.isDragging=!1,this.container.style.cursor="grab"}zoom(e){let r=Math.min(Math.max(this.scale+e,this.MIN_SCALE),this.MAX_SCALE),t=this.content.getBoundingClientRect(),o=t.width/2,n=t.height/2,c=r-this.scale;this.currentPan.x-=o*c,this.currentPan.y-=n*c,this.scale=r,this.updateTransform()}updateTransform(){this.content.style.transform=`translate(${this.currentPan.x}px, ${this.currentPan.y}px) scale(${this.scale})`}resetTransform(){this.scale=1;let e=this.content.querySelector("svg");this.currentPan={x:e.getBoundingClientRect().width/2,y:e.getBoundingClientRect().height/2},this.updateTransform()}},C=["--secondary","--tertiary","--gray","--light","--lightgray","--highlight","--dark","--darkgray","--codeFont"],E;document.addEventListener("nav",async()=>{let e=document.querySelector(".center").querySelectorAll("code.mermaid");if(e.length===0)return;E||=await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.esm.min.mjs");let r=E.default,t=new WeakMap;for(let n of e)t.set(n,n.innerText);async function o(){for(let s of e){s.removeAttribute("data-processed");let a=t.get(s);a&&(s.innerHTML=a)}let n=C.reduce((s,a)=>(s[a]=window.getComputedStyle(document.documentElement).getPropertyValue(a),s),{}),c=document.documentElement.getAttribute("saved-theme")==="dark";r.initialize({startOnLoad:!1,securityLevel:"loose",theme:c?"dark":"base",themeVariables:{fontFamily:n["--codeFont"],primaryColor:n["--light"],primaryTextColor:n["--darkgray"],primaryBorderColor:n["--tertiary"],lineColor:n["--darkgray"],secondaryColor:n["--secondary"],tertiaryColor:n["--tertiary"],clusterBkg:n["--light"],edgeLabelBackground:n["--highlight"]}}),await r.run({nodes:e})}await o(),document.addEventListener("themechange",o),window.addCleanup(()=>document.removeEventListener("themechange",o));for(let n=0;n<e.length;n++){let v=function(){let g=l.querySelector("#mermaid-space"),m=l.querySelector(".mermaid-content");if(!m)return;y(m);let w=c.querySelector("svg").cloneNode(!0);m.appendChild(w),l.classList.add("active"),g.style.cursor="grab",u=new h(g,m)},M=function(){l.classList.remove("active"),u?.cleanup(),u=null},c=e[n],s=c.parentElement,a=s.querySelector(".clipboard-button"),d=s.querySelector(".expand-button"),p=window.getComputedStyle(a),L=a.offsetWidth+parseFloat(p.marginLeft||"0")+parseFloat(p.marginRight||"0");d.style.right=`calc(${L}px + 0.3rem)`,s.prepend(d);let l=s.querySelector("#mermaid-container");if(!l)return;let u=null;d.addEventListener("click",v),f(l,M),window.addCleanup(()=>{u?.cleanup(),d.removeEventListener("click",v)})}});
</script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script src="../postscript.js" type="module"></script></html>